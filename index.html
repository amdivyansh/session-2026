<!DOCTYPE html>
<html lang="en" class="dark scroll-smooth">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOSE '26 | The Final Party</title>

    <!-- DNS Prefetch for media CDN -->
    <link rel="dns-prefetch" href="https://media.githubusercontent.com">
    <link rel="preconnect" href="https://media.githubusercontent.com" crossorigin>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Righteous&family=Outfit:wght@300;400;600;800&family=Great+Vibes&family=Space+Grotesk:wght@300;500;700&display=swap"
        rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Lenis Smooth Scroll -->
    <link rel="stylesheet" href="https://unpkg.com/lenis@1.3.17/dist/lenis.css">
    <script src="https://unpkg.com/lenis@1.3.17/dist/lenis.min.js"></script>

    <!-- Configuration for Tailwind -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'sans-serif'],
                        display: ['Righteous', 'cursive'],
                        script: ['Great Vibes', 'cursive'],
                        mono: ['Space Grotesk', 'monospace'],
                    },
                    colors: {
                        party: {
                            bg: '#030014', // Darker, richer black/violet
                            card: 'rgba(255, 255, 255, 0.03)',
                            border: 'rgba(255, 255, 255, 0.1)',
                            pink: '#FF00FF',
                            purple: '#9D00FF',
                            cyan: '#00F0FF',
                            gold: '#FFD700',
                        }
                    },
                    backgroundImage: {
                        'neon-gradient': 'linear-gradient(to right, #FF00FF, #9D00FF, #00F0FF)',
                        'disco-gradient': 'radial-gradient(circle at 50% 50%, rgba(157, 0, 255, 0.2), rgba(3, 0, 20, 0))',
                    },
                    boxShadow: {
                        'neon-pink': '0 0 10px rgba(255, 0, 255, 0.5), 0 0 20px rgba(255, 0, 255, 0.3)',
                        'neon-cyan': '0 0 10px rgba(0, 240, 255, 0.5), 0 0 20px rgba(0, 240, 255, 0.3)',
                        'card-hover': '0 20px 40px -10px rgba(0,0,0,0.5)',
                    },
                    animation: {
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'float': 'float 6s ease-in-out infinite',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                        'slide-up': 'slideUp 0.8s ease-out forwards',
                        'spin-slow': 'spin 12s linear infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' },
                        },
                        glow: {
                            '0%': { filter: 'drop-shadow(0 0 2px #ff00ff)' },
                            '100%': { filter: 'drop-shadow(0 0 10px #00eaff)' },
                        },
                        slideUp: {
                            '0%': { opacity: '0', transform: 'translateY(40px)' },
                            '100%': { opacity: '1', transform: 'translateY(0)' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #030014;
            color: white;
            overflow-x: hidden;
        }

        /* Film Grain Overlay */
        .noise-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 50;
            opacity: 0.03;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }

        /* Ambient Orbs */
        .orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            z-index: -1;
            opacity: 0.5;
            animation: float 10s infinite;
        }

        /* Animated Party Stars Background */
        .party-stars-container {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .party-star {
            position: absolute;
            border-radius: 50%;
            animation: starFloat linear infinite, starTwinkle ease-in-out infinite alternate;
        }

        .party-star.shape-cross {
            border-radius: 0;
            background: none !important;
        }

        .party-star.shape-cross::before,
        .party-star.shape-cross::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .party-star.shape-cross::before {
            width: 100%;
            height: 30%;
            background: inherit;
            background: var(--star-color);
            border-radius: 2px;
        }

        .party-star.shape-cross::after {
            width: 30%;
            height: 100%;
            background: var(--star-color);
            border-radius: 2px;
        }

        .party-star.shape-diamond {
            border-radius: 2px;
            transform: rotate(45deg);
        }

        @keyframes starFloat {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }

            10% {
                opacity: 1;
            }

            90% {
                opacity: 1;
            }

            100% {
                transform: translateY(-10vh) rotate(360deg);
                opacity: 0;
            }
        }

        @keyframes starTwinkle {
            0% {
                opacity: 0.3;
                box-shadow: 0 0 4px currentColor;
            }

            100% {
                opacity: 1;
                box-shadow: 0 0 12px currentColor, 0 0 24px currentColor;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #030014;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, #FF00FF, #00F0FF);
            border-radius: 3px;
        }

        /* Masonry Layout */
        .masonry-grid {
            column-count: 1;
            column-gap: 1rem;
        }

        @media (min-width: 640px) {
            .masonry-grid {
                column-count: 2;
                column-gap: 1.25rem;
            }
        }

        @media (min-width: 1024px) {
            .masonry-grid {
                column-count: 4;
                column-gap: 1.25rem;
            }
        }

        .masonry-item {
            break-inside: avoid;
            margin-bottom: 1.25rem;
            transform-style: preserve-3d;
            perspective: 1000px;
            contain: content;
            /* Isolate reflows — big perf win with many cards */
        }

        /* Cap media height for denser layout */
        .masonry-item .media-container {
            max-height: 240px;
            overflow: hidden;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #0a0520;
            min-height: 120px;
        }

        .masonry-item .media-container img,
        .masonry-item .media-container video {
            width: 100%;
            height: auto;
            max-height: 240px;
            object-fit: cover !important;
            object-position: center;
            display: block;
        }

        @media (min-width: 640px) {
            .masonry-item .media-container {
                max-height: 300px;
            }

            .masonry-item .media-container img,
            .masonry-item .media-container video {
                max-height: 300px;
            }
        }

        @media (min-width: 1024px) {
            .masonry-item .media-container {
                max-height: 340px;
            }

            .masonry-item .media-container img,
            .masonry-item .media-container video {
                max-height: 340px;
            }
        }

        /* Media Loading Skeleton */
        .media-skeleton {
            position: absolute;
            inset: 0;
            background: linear-gradient(110deg, #0a0520 30%, #150a35 50%, #0a0520 70%);
            background-size: 300% 100%;
            animation: skeletonPulse 1.5s ease-in-out infinite;
            z-index: 2;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .media-skeleton::after {
            content: '';
            width: 32px;
            height: 32px;
            border: 3px solid rgba(157, 0, 255, 0.2);
            border-top-color: rgba(0, 240, 255, 0.6);
            border-radius: 50%;
            animation: skeletonSpin 0.8s linear infinite;
        }

        @keyframes skeletonPulse {
            0% {
                background-position: 100% 0;
            }

            100% {
                background-position: -100% 0;
            }
        }

        @keyframes skeletonSpin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Animation Toggle Button */
        .anim-toggle-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.6);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .anim-toggle-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(0, 240, 255, 0.3);
            color: #00F0FF;
        }

        .anim-toggle-btn.off {
            border-color: rgba(255, 0, 255, 0.3);
            color: #FF00FF;
        }

        .anim-toggle-btn .tooltip {
            position: absolute;
            bottom: -32px;
            left: 50%;
            transform: translateX(-50%);
            white-space: nowrap;
            font-size: 10px;
            font-family: 'Space Grotesk', monospace;
            color: rgba(255, 255, 255, 0.5);
            background: rgba(0, 0, 0, 0.8);
            padding: 3px 8px;
            border-radius: 4px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .anim-toggle-btn:hover .tooltip {
            opacity: 1;
        }

        /* Animations OFF mode */
        body.animations-off *,
        body.animations-off *::before,
        body.animations-off *::after {
            animation-duration: 0s !important;
            animation-delay: 0s !important;
            transition-duration: 0s !important;
        }

        body.animations-off .orb,
        body.animations-off .party-stars-container,
        body.animations-off .noise-overlay {
            display: none !important;
        }

        body.animations-off .media-skeleton {
            animation: none !important;
            background: #0a0520 !important;
        }

        body.animations-off .media-skeleton::after {
            animation: none !important;
            border-color: rgba(157, 0, 255, 0.3) !important;
        }

        /* Disable expensive backdrop-blur on mobile when animations off */
        @media (max-width: 768px) {

            body.animations-off .backdrop-blur-sm,
            body.animations-off .backdrop-blur-md,
            body.animations-off .backdrop-blur-xl,
            body.animations-off [class*="backdrop-blur"] {
                backdrop-filter: none !important;
                -webkit-backdrop-filter: none !important;
            }
        }

        /* Confetti */
        .confetti {
            position: fixed;
            width: 8px;
            height: 8px;
            background-color: #f0f;
            animation: confetti-fall 5s linear forwards;
            z-index: 40;
        }

        @keyframes confetti-fall {
            0% {
                transform: translateY(-10vh) rotate(0deg);
                opacity: 1;
            }

            100% {
                transform: translateY(110vh) rotate(720deg);
                opacity: 0;
            }
        }

        /* Loader */
        .loader-container {
            position: fixed;
            inset: 0;
            background: #030014;
            z-index: 100;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: opacity 0.5s ease-out;
        }

        .equalizer {
            display: flex;
            gap: 4px;
            height: 40px;
            align-items: flex-end;
        }

        .bar {
            width: 8px;
            background: linear-gradient(to top, #FF00FF, #00F0FF);
            animation: equalize 1s ease-in-out infinite;
        }

        .bar:nth-child(1) {
            animation-delay: 0.1s;
            height: 60%;
        }

        .bar:nth-child(2) {
            animation-delay: 0.3s;
            height: 80%;
        }

        .bar:nth-child(3) {
            animation-delay: 0.5s;
            height: 40%;
        }

        .bar:nth-child(4) {
            animation-delay: 0.2s;
            height: 90%;
        }

        .bar:nth-child(5) {
            animation-delay: 0.4s;
            height: 50%;
        }

        @keyframes equalize {

            0%,
            100% {
                height: 20%;
            }

            50% {
                height: 100%;
            }
        }

        /* Tablet adjustments */
        @media (min-width: 640px) and (max-width: 1023px) {
            .student-dropdown-panel {
                width: 280px;
            }
        }
    </style>
</head>

<body class="min-h-screen flex flex-col relative selection:bg-party-pink selection:text-white">

    <!-- Noise Texture -->
    <div class="noise-overlay"></div>

    <!-- Animated Party Stars Background -->
    <div class="party-stars-container" id="party-stars-container"></div>

    <!-- Loader -->
    <div id="loader" class="loader-container">
        <div class="flex flex-col items-center gap-4">
            <div class="equalizer">
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
            </div>
            <p class="font-mono text-party-cyan text-xs tracking-[0.3em] uppercase animate-pulse">Loading Vibes...</p>
        </div>
    </div>

    <!-- Ambient Lighting -->
    <div class="orb bg-party-purple w-[600px] h-[600px] top-[-200px] left-[-100px] animate-pulse-slow"></div>
    <div class="orb bg-party-cyan w-[500px] h-[500px] bottom-[-100px] right-[-100px] animate-pulse-slow"
        style="animation-delay: 2s;"></div>
    <div class="orb bg-party-pink w-[300px] h-[300px] top-[40%] left-[30%] opacity-20 animate-float"
        style="animation-duration: 15s;"></div>

    <!-- Navigation -->
    <nav
        class="fixed top-0 w-full z-40 bg-party-bg/60 backdrop-blur-md border-b border-white/5 transition-all duration-300">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <div class="flex items-center space-x-3 group cursor-pointer" onclick="window.scrollTo(0,0)">
                    <div class="flex flex-col">
                        <span
                            class="font-display text-2xl tracking-widest text-white leading-none group-hover:text-party-pink transition-colors">SOSE
                            <span class="text-party-cyan">'26</span></span>
                        <span class="text-[9px] font-mono text-gray-400 tracking-[0.2em] uppercase">12th Class
                            Farewell</span>
                    </div>
                </div>
                <div class="flex items-center space-x-4">

                    <a href="#gallery"
                        class="hidden sm:inline-flex items-center justify-center px-6 py-2 overflow-hidden font-bold text-white transition-all duration-300 bg-white/5 border border-white/10 rounded-full hover:bg-white/10 group focus:outline-none focus:ring-2 focus:ring-party-cyan focus:ring-offset-2 focus:ring-offset-gray-900">
                        <span
                            class="absolute w-full h-full -mt-10 transition-all duration-1000 transform translate-x-12 bg-white opacity-10 rotate-12 group-hover:-translate-x-40 ease"></span>
                        <span class="relative text-xs tracking-widest flex items-center gap-2">
                            OPEN GALLERY <i class="fa-solid fa-arrow-down text-party-pink animate-bounce"></i>
                        </span>
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="relative pt-36 pb-20 sm:pt-48 sm:pb-32 px-4 text-center z-20">
        <div class="max-w-6xl mx-auto relative">

            <!-- Floating Elements -->
            <i
                class="fa-solid fa-star text-party-gold text-2xl absolute top-0 left-[10%] animate-spin-slow opacity-60"></i>
            <i class="fa-solid fa-star-of-life text-party-cyan text-xl absolute bottom-10 right-[15%] animate-spin-slow opacity-60"
                style="animation-direction: reverse;"></i>

            <!-- Neon Text Effect -->
            <div class="relative inline-block mb-4">
                <p
                    class="font-script text-4xl sm:text-6xl text-party-gold opacity-90 rotate-[-3deg] drop-shadow-[0_0_10px_rgba(255,215,0,0.5)] animate-slide-up">
                    The Final Chapter
                </p>
            </div>

            <h1
                class="font-display text-7xl sm:text-8xl md:text-9xl mb-8 leading-[0.9] tracking-tighter drop-shadow-[0_0_25px_rgba(189,0,255,0.4)]">
                <span class="block text-white animate-slide-up" style="animation-delay: 0.1s;">SOSE</span>
                <span
                    class="block text-transparent bg-clip-text bg-gradient-to-r from-party-cyan via-white to-party-pink animate-slide-up bg-[length:200%_auto] hover:bg-right transition-all duration-500"
                    style="animation-delay: 0.3s;">BATCH '26</span>
            </h1>

            <p class="max-w-2xl mx-auto text-lg md:text-xl text-gray-300 mb-12 font-light leading-relaxed animate-slide-up px-4"
                style="animation-delay: 0.5s;">
                Tonight, we trade our uniforms for memories.
                <span class="text-party-cyan font-semibold drop-shadow-[0_0_8px_rgba(0,240,255,0.5)]">Dress up, show up,
                    and never forget.</span>
            </p>

            <!-- Cyberpunk Filters -->
            <div class="flex flex-wrap justify-center gap-3 sm:gap-4 animate-slide-up items-center relative"
                style="animation-delay: 0.7s; z-index: 45;">
                <button onclick="filterGallery('all')"
                    class="filter-btn active px-8 py-3 rounded-full bg-white text-black font-bold hover:scale-105 transition-transform shadow-[0_0_25px_rgba(255,255,255,0.4)] border-2 border-transparent"
                    data-filter="all">
                    ALL VIBES
                </button>
                <button onclick="filterGallery('image')"
                    class="filter-btn px-8 py-3 rounded-full bg-black/40 border border-party-cyan/30 text-party-cyan hover:bg-party-cyan hover:text-black hover:shadow-neon-cyan transition-all duration-300 font-bold backdrop-blur-md"
                    data-filter="image">
                    PHOTOS
                </button>
                <button onclick="filterGallery('video')"
                    class="filter-btn px-8 py-3 rounded-full bg-black/40 border border-party-pink/30 text-party-pink hover:bg-party-pink hover:text-black hover:shadow-neon-pink transition-all duration-300 font-bold backdrop-blur-md"
                    data-filter="video">
                    VIDEOS
                </button>
            </div>

            <!-- Media Count Badge -->
            <div class="flex justify-center">
                <div class="media-count-badge" id="media-count-badge" style="display: none;">
                    <i class="fa-solid fa-images text-party-pink" style="font-size: 10px;"></i>
                    <span>Showing <span class="count" id="media-count">0</span> items</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Gallery Section -->
    <main id="gallery" class="flex-grow relative z-10 px-4 sm:px-6 lg:px-8 pb-32 max-w-[1600px] mx-auto w-full">
        <!-- Grid Container -->
        <div id="gallery-grid" class="masonry-grid opacity-0 transition-opacity duration-700">
            <!-- Items will be injected here by JS -->
        </div>
    </main>

    <!-- Floating Music Widget (Visual Only) -->
    <!-- Floating Party Mode Toggle (Animation Control) -->
    <button id="party-mode-toggle" onclick="toggleAnimations()"
        class="fixed bottom-6 right-6 z-40 flex items-center gap-3 bg-black/60 backdrop-blur-xl border border-white/10 px-4 py-2 rounded-full shadow-lg animate-fade-in-up cursor:pointer hover:bg-black/80 hover:border-party-pink/50 transition-all active:scale-95 group">
        <div class="flex gap-1 h-4 items-end" id="party-bars">
            <div class="w-1 bg-party-cyan animate-[equalize_1s_infinite]"></div>
            <div class="w-1 bg-party-pink animate-[equalize_1.2s_infinite]"></div>
            <div class="w-1 bg-party-purple animate-[equalize_0.8s_infinite]"></div>
        </div>
        <span id="party-text"
            class="text-xs font-mono text-gray-300 uppercase tracking-widest group-hover:text-white transition-colors">Party
            Mode On</span>
    </button>

    <!-- Footer -->
    <footer class="border-t border-white/5 bg-black/40 backdrop-blur-lg py-12 relative z-10">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <div class="flex justify-center space-x-6 mb-8">
                <a href="#"
                    class="group w-12 h-12 rounded-full bg-white/5 border border-white/5 flex items-center justify-center hover:bg-party-pink hover:border-party-pink transition-all duration-300 hover:-translate-y-2">
                    <i class="fa-brands fa-instagram text-xl text-gray-400 group-hover:text-white"></i>
                </a>
                <a href="#"
                    class="group w-12 h-12 rounded-full bg-white/5 border border-white/5 flex items-center justify-center hover:bg-party-cyan hover:border-party-cyan transition-all duration-300 hover:-translate-y-2">
                    <i class="fa-brands fa-tiktok text-xl text-gray-400 group-hover:text-black"></i>
                </a>
            </div>
            <div class="inline-block px-4 py-1 border border-white/10 rounded-full bg-white/5 mb-4">
                <p class="font-mono text-xs text-party-gold tracking-[0.2em] uppercase">Est. 2026</p>
            </div>
            <p class="font-display text-gray-500 tracking-widest text-sm mb-4">MADE FOR SOSE CLASS 12</p>
            <div class="mt-4 pt-6 border-t border-white/5">
                <p class="font-mono text-xs text-gray-600 tracking-wider">
                    Made with <span class="text-party-pink animate-pulse inline-block">❤️</span> by
                    <a href="https://dkydivyansh.com" target="_blank" rel="noopener noreferrer"
                        class="text-party-cyan hover:text-white transition-colors duration-300 font-semibold"
                        style="text-decoration: none;">dkydivyansh</a>
                </p>
            </div>
        </div>
    </footer>

    <!-- Lightbox Modal -->
    <div id="lightbox" class="fixed inset-0 z-50 hidden opacity-0 transition-opacity duration-300" aria-modal="true"
        role="dialog">
        <!-- Backdrop -->
        <div class="absolute inset-0 bg-black/95 backdrop-blur-xl" onclick="closeLightbox()"></div>

        <!-- Controls -->
        <button
            class="absolute top-6 right-6 w-12 h-12 rounded-full bg-white/10 hover:bg-party-pink hover:shadow-neon-pink text-white z-50 transition-all flex items-center justify-center group"
            onclick="closeLightbox()">
            <i class="fa-solid fa-xmark text-xl group-hover:rotate-90 transition-transform"></i>
        </button>

        <button
            class="absolute left-4 sm:left-8 top-1/2 -translate-y-1/2 w-14 h-14 rounded-full bg-white/5 hover:bg-white/20 border border-white/10 text-white z-50 transition-all hover:scale-110 hidden sm:flex items-center justify-center backdrop-blur-md hover:border-party-cyan/50"
            onclick="navigate(-1)">
            <i class="fa-solid fa-chevron-left text-xl"></i>
        </button>

        <button
            class="absolute right-4 sm:right-8 top-1/2 -translate-y-1/2 w-14 h-14 rounded-full bg-white/5 hover:bg-white/20 border border-white/10 text-white z-50 transition-all hover:scale-110 hidden sm:flex items-center justify-center backdrop-blur-md hover:border-party-cyan/50"
            onclick="navigate(1)">
            <i class="fa-solid fa-chevron-right text-xl"></i>
        </button>

        <!-- Content Container -->
        <div class="absolute inset-0 flex items-center justify-center p-4 sm:p-12 pointer-events-none">
            <div id="lightbox-content"
                class="pointer-events-auto relative max-w-full max-h-full flex flex-col items-center">
                <!-- Media -->
                <div id="media-container"
                    class="relative rounded-xl overflow-hidden shadow-[0_0_60px_rgba(0,0,0,0.9)] border border-white/10 bg-black ring-1 ring-white/10">
                    <!-- Image or Video tag goes here -->
                </div>

                <!-- Caption -->
                <div id="lightbox-caption"
                    class="mt-6 text-center max-w-2xl bg-black/40 backdrop-blur-md px-6 py-4 rounded-xl border border-white/5">
                    <h3 class="font-display text-2xl text-white tracking-wide"></h3>
                    <div class="flex items-center justify-center gap-2 mt-2">
                        <div class="h-px w-8 bg-party-cyan"></div>
                        <p class="font-mono text-party-pink text-xs uppercase tracking-widest"></p>
                        <div class="h-px w-8 bg-party-cyan"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // --- DATA (loaded from JSON files) ---
        let galleryData = [];

        // --- APP STATE ---
        let filteredData = [];
        let currentIndex = 0;
        let currentTypeFilter = 'all';
        let lenis; // Lenis instance

        // --- DOM ELEMENTS ---
        const grid = document.getElementById('gallery-grid');
        const loader = document.getElementById('loader');
        const lightbox = document.getElementById('lightbox');
        const lightboxContent = document.getElementById('media-container');
        const lightboxTitle = document.querySelector('#lightbox-caption h3');
        const lightboxDesc = document.querySelector('#lightbox-caption p');

        // --- LOAD DATA FROM JSON ---
        async function loadData() {
            try {
                const mediaRes = await fetch('media.json');
                const mediaJson = await mediaRes.json();

                // Map media.json to gallery format (supports both old `uri` and new `src` field)
                galleryData = mediaJson.map((item, i) => ({
                    id: item.id || i + 1,
                    type: item.type || 'image',
                    src: item.src || item.uri,
                    thumbnail: item.thumbnail || null,
                    title: item.title || 'Untitled',
                    description: item.description || '',
                    date: item.date || '',
                    tags: item.tags || [],
                }));

                // Randomize Array (Fisher-Yates Shuffle)
                for (let i = galleryData.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [galleryData[i], galleryData[j]] = [galleryData[j], galleryData[i]];
                }

            } catch (err) {
                console.error('Error loading data:', err);
                // Fallback: show empty state
                galleryData = [];
            }
        }

        // --- ANIMATION TOGGLE ---
        let animationsEnabled = localStorage.getItem('animationsOff') !== 'true';

        function toggleAnimations() {
            animationsEnabled = !animationsEnabled;
            document.body.classList.toggle('animations-off', !animationsEnabled);
            localStorage.setItem('animationsOff', !animationsEnabled);

            updatePartyModeUI();
        }

        function updatePartyModeUI() {
            const text = document.getElementById('party-text');
            const bars = document.getElementById('party-bars').children;

            if (animationsEnabled) {
                text.textContent = "Party Mode On";
                text.classList.remove('text-gray-500');
                text.classList.add('text-gray-300');

                // Restart animations
                bars[0].style.animation = 'equalize 1s infinite';
                bars[1].style.animation = 'equalize 1.2s infinite';
                bars[2].style.animation = 'equalize 0.8s infinite';

                // Re-enable confetti/stars if loading for first time or just toggled
                const stars = document.getElementById('party-stars-container');
                if (stars) stars.style.display = 'block';

                // Enable Smooth Scroll
                if (!lenis) {
                    lenis = new Lenis({ autoRaf: true });
                }

            } else {
                text.textContent = "Party Mode Off";
                text.classList.add('text-gray-500');
                text.classList.remove('text-gray-300');

                // Stop animations
                Array.from(bars).forEach(bar => {
                    bar.style.animation = 'none';
                    bar.style.height = '40%'; // Static height
                });

                const stars = document.getElementById('party-stars-container');
                if (stars) stars.style.display = 'none';

                // Disable Smooth Scroll (Native scroll is faster on low-end)
                if (lenis) {
                    lenis.destroy();
                    lenis = null;
                }
            }
        }

        function initAnimationToggle() {
            if (!animationsEnabled) {
                document.body.classList.add('animations-off');
            }
            updatePartyModeUI();
        }

        // --- INITIALIZATION ---
        document.addEventListener('DOMContentLoaded', async () => {
            initAnimationToggle();

            if (animationsEnabled) {
                triggerConfetti();
            }
            spawnPartyStars();
            await loadData();

            setTimeout(() => {
                loader.style.opacity = '0';
                setTimeout(() => {
                    loader.style.display = 'none';
                    grid.classList.remove('opacity-0');
                    applyFilters();
                }, 500);
            }, 1200);
        });

        // --- EFFECTS ---
        function triggerConfetti() {
            const colors = ['#FF00FF', '#00F0FF', '#FFD700', '#ffffff'];
            for (let i = 0; i < 60; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                confetti.style.left = Math.random() * 100 + 'vw';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
                confetti.style.opacity = Math.random();
                document.body.appendChild(confetti);

                setTimeout(() => confetti.remove(), 5000);
            }
        }

        // Animated background party stars
        function spawnPartyStars() {
            const container = document.getElementById('party-stars-container');
            if (!container) return;

            const colors = ['#FF00FF', '#00F0FF', '#FFD700', '#9D00FF', '#ffffff', '#ff66b2', '#66ffcc'];
            const shapes = ['', 'shape-cross', 'shape-diamond'];
            const starCount = 35;

            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('div');
                const color = colors[Math.floor(Math.random() * colors.length)];
                const shape = shapes[Math.floor(Math.random() * shapes.length)];
                const size = Math.random() * 5 + 2; // 2px to 7px
                const left = Math.random() * 100;
                const floatDuration = Math.random() * 20 + 15; // 15s to 35s
                const twinkleDuration = Math.random() * 2 + 1; // 1s to 3s
                const delay = Math.random() * 25; // stagger start times

                star.className = `party-star ${shape}`;
                star.style.cssText = `
                    left: ${left}%;
                    width: ${size}px;
                    height: ${size}px;
                    background: ${shape === 'shape-cross' ? 'none' : color};
                    color: ${color};
                    --star-color: ${color};
                    animation-duration: ${floatDuration}s, ${twinkleDuration}s;
                    animation-delay: ${delay}s, ${Math.random() * 2}s;
                `;

                container.appendChild(star);
            }
        }

        // TILT EFFECT FUNCTION (disabled on touch devices — saves CPU)
        const isTouchDevice = window.matchMedia('(hover: none)').matches;

        function addTiltEffect(element) {
            if (isTouchDevice) return; // Skip on phones/tablets

            element.addEventListener('mousemove', (e) => {
                const rect = element.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;

                const centerX = rect.width / 2;
                const centerY = rect.height / 2;

                const rotateX = ((y - centerY) / centerY) * -5;
                const rotateY = ((x - centerX) / centerX) * 5;

                element.style.transform = `perspective(1000px) rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale3d(1.02, 1.02, 1.02)`;
            });

            element.addEventListener('mouseleave', () => {
                element.style.transform = 'perspective(1000px) rotateX(0) rotateY(0) scale3d(1, 1, 1)';
            });
        }

        // =============================================
        //  COMBINED FILTER LOGIC
        // =============================================
        function applyFilters() {
            let data = [...galleryData];

            // Type filter (all, image, video)
            if (currentTypeFilter !== 'all') {
                data = data.filter(item => item.type === currentTypeFilter);
            }

            filteredData = data;

            // Update media count badge
            const badge = document.getElementById('media-count-badge');
            const countEl = document.getElementById('media-count');
            if (currentTypeFilter !== 'all') {
                badge.style.display = 'inline-flex';
                countEl.textContent = filteredData.length;
            } else {
                badge.style.display = 'none';
            }

            renderGallery();
        }

        // --- RENDER FUNCTION ---
        function renderGallery() {
            grid.innerHTML = '';

            if (filteredData.length === 0) {
                grid.innerHTML = `
                    <div style="column-span: all; text-align: center; padding: 60px 20px;">
                        <i class="fa-solid fa-face-sad-tear" style="font-size: 48px; color: rgba(157, 0, 255, 0.3); margin-bottom: 16px;"></i>
                        <p style="font-family: 'Space Grotesk', monospace; color: rgba(255,255,255,0.3); text-transform: uppercase; letter-spacing: 0.15em; font-size: 13px;">No media found for this filter</p>
                    </div>
                `;
                return;
            }

            filteredData.forEach((item, index) => {
                const element = document.createElement('div');
                element.className = 'masonry-item group relative cursor-pointer transition-transform duration-200 ease-out';
                element.onclick = () => openLightbox(index);

                // Add 3D Tilt Listener
                addTiltEffect(element);

                // --- GLASS CARD STYLE ---
                const innerHTML = `
                    <div class="relative overflow-hidden rounded-xl bg-party-card border border-white/5 backdrop-blur-sm group-hover:border-party-cyan/30 group-hover:shadow-neon-cyan transition-all duration-300">
                        <!-- Image/Thumbnail Container -->
                        <div class="media-container relative">
                            <!-- Loading Skeleton -->
                            <div class="media-skeleton"></div>
                            ${item.type === 'video' ? `
                                ${(item.thumbnail && !item.thumbnail.match(/\.(mp4|mov|webm|ogg)$/i)) ? `
                                    <img data-src="${item.thumbnail}" alt="${item.title}" loading="lazy" onload="this.parentElement.querySelector('.media-skeleton')?.remove()" onerror="this.parentElement.querySelector('.media-skeleton')?.remove()" class="lazy-media opacity-90 group-hover:opacity-100 transition-opacity duration-700">
                                ` : `
                                    <video data-src="${item.src}" preload="none" muted playsinline onloadeddata="this.parentElement.querySelector('.media-skeleton')?.remove()" onerror="this.parentElement.querySelector('.media-skeleton')?.remove()" class="lazy-media opacity-90 group-hover:opacity-100 transition-opacity duration-700"></video>
                                `}
                                <div class="absolute inset-0 flex items-center justify-center" style="z-index:3">
                                    <div class="w-14 h-14 rounded-full bg-black/40 backdrop-blur-xl border border-white/30 flex items-center justify-center group-hover:scale-110 transition-transform shadow-[0_0_30px_rgba(255,0,255,0.4)]">
                                        <i class="fa-solid fa-play text-white ml-1 text-xl"></i>
                                    </div>
                                </div>
                            ` : `
                                <img data-src="${item.src}" alt="${item.title}" loading="lazy" onload="this.parentElement.querySelector('.media-skeleton')?.remove()" onerror="this.parentElement.querySelector('.media-skeleton')?.remove()" class="lazy-media opacity-90 group-hover:opacity-100 transition-opacity duration-700">
                            `}
                            
                            <!-- Overlay Gradient -->
                            <div class="absolute inset-0 bg-gradient-to-t from-black via-transparent to-transparent opacity-60 group-hover:opacity-80 transition-opacity"></div>
                        </div>
                        
                        <!-- Content -->
                        <div class="absolute bottom-0 left-0 w-full p-6 translate-y-4 group-hover:translate-y-0 transition-transform duration-300">
                            <span class="inline-block px-2 py-0.5 rounded text-[10px] font-mono font-bold uppercase tracking-wider bg-party-pink/20 text-party-pink border border-party-pink/30 mb-2 backdrop-blur-md shadow-lg">${item.date}</span>
                            ${item.title && item.title.trim() ? `<h3 class="font-display text-2xl text-white leading-none drop-shadow-md group-hover:text-party-cyan transition-colors mb-2">${item.title}</h3>` : ''}
                        </div>
                    </div>
                `;

                element.innerHTML = innerHTML;
                grid.appendChild(element);
            });

            // Lazy-load media with IntersectionObserver (only load when near viewport)
            setupLazyMedia();

            // Update Active Buttons
            updateFilterButtons();
        }

        // --- LAZY MEDIA LOADER ---
        // Only loads video metadata / image src when the card scrolls near the viewport
        function setupLazyMedia() {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (!entry.isIntersecting) return;

                    const el = entry.target;
                    const src = el.dataset.src;
                    if (!src) return;

                    if (el.tagName === 'VIDEO') {
                        // Load only metadata (first frame) — NOT the full video
                        el.src = src;
                        el.preload = 'metadata';
                    } else {
                        el.src = src;
                    }

                    el.removeAttribute('data-src');
                    observer.unobserve(el);
                });
            }, {
                rootMargin: '200px 0px',  // Start loading 200px before entering viewport
                threshold: 0
            });

            document.querySelectorAll('.lazy-media[data-src]').forEach(el => {
                observer.observe(el);
            });
        }

        function updateFilterButtons() {
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if (btn.dataset.filter === currentTypeFilter) {
                    btn.classList.remove('bg-black/40', 'border-party-cyan/30', 'text-party-cyan', 'border-party-pink/30', 'text-party-pink');
                    btn.classList.add('bg-white', 'text-black', 'shadow-neon-cyan', 'scale-105');
                } else {
                    btn.classList.add('bg-black/40');
                    btn.classList.remove('bg-white', 'text-black', 'shadow-neon-cyan', 'scale-105');

                    // Re-add specific colors based on original class
                    if (btn.dataset.filter === 'image') {
                        btn.classList.add('border-party-cyan/30', 'text-party-cyan');
                    } else if (btn.dataset.filter === 'video') {
                        btn.classList.add('border-party-pink/30', 'text-party-pink');
                    }
                }
            });
        }

        function filterGallery(type) {
            currentTypeFilter = type;

            const gridEl = document.getElementById('gallery-grid');
            gridEl.style.opacity = '0';
            gridEl.style.transform = 'translateY(20px)';

            setTimeout(() => {
                applyFilters();
                gridEl.style.opacity = '1';
                gridEl.style.transform = 'translateY(0)';
            }, 300);
        }

        // --- LIGHTBOX FUNCTIONS ---
        function openLightbox(index) {
            currentIndex = index;
            updateLightboxContent();
            lightbox.classList.remove('hidden');
            setTimeout(() => { lightbox.classList.remove('opacity-0'); }, 10);
            document.body.style.overflow = 'hidden';
        }

        function closeLightbox() {
            // Stop any playing video to free memory
            const vid = lightboxContent.querySelector('video');
            if (vid) { vid.pause(); vid.removeAttribute('src'); vid.load(); }

            lightbox.classList.add('opacity-0');
            setTimeout(() => {
                lightbox.classList.add('hidden');
                lightboxContent.innerHTML = '';
            }, 300);
            document.body.style.overflow = '';
        }

        function updateLightboxContent() {
            const item = filteredData[currentIndex];
            // Stop previous video before switching
            const prevVid = lightboxContent.querySelector('video');
            if (prevVid) { prevVid.pause(); prevVid.removeAttribute('src'); prevVid.load(); }
            lightboxContent.innerHTML = ''; // Clear

            if (item.type === 'video') {
                lightboxContent.innerHTML = `
                    <video controls autoplay playsinline class="max-w-full max-h-[80vh] shadow-2xl outline-none bg-black rounded-lg">
                        <source src="${item.src}" type="video/mp4">
                    </video>
                `;
            } else {
                lightboxContent.innerHTML = `
                    <img src="${item.src}" alt="${item.title}" class="max-w-full max-h-[80vh] object-contain shadow-2xl rounded-lg">
                `;
            }

            if (item.title && item.title.trim()) {
                lightboxTitle.textContent = item.title;
                lightboxTitle.style.display = 'block';
            } else {
                lightboxTitle.textContent = '';
                lightboxTitle.style.display = 'none';
            }

            lightboxDesc.textContent = item.description + (item.date ? ' • ' + item.date : '');
        }

        function navigate(direction) {
            currentIndex += direction;
            if (currentIndex < 0) currentIndex = filteredData.length - 1;
            if (currentIndex >= filteredData.length) currentIndex = 0;

            // Fade effect inside modal
            const container = document.getElementById('media-container');
            container.style.transform = 'scale(0.95)';
            container.style.opacity = '0.5';

            setTimeout(() => {
                updateLightboxContent();
                container.style.transform = 'scale(1)';
                container.style.opacity = '1';
            }, 200);
        }

        document.addEventListener('keydown', (e) => {
            if (lightbox.classList.contains('hidden')) return;
            if (e.key === 'Escape') closeLightbox();
            if (e.key === 'ArrowLeft') navigate(-1);
            if (e.key === 'ArrowRight') navigate(1);
        });
    </script>
</body>

</html>